<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.10.0" xml:lang="en-US">
  <compounddef id="writer_8py" kind="file" language="Python">
    <compoundname>writer.py</compoundname>
    <innerclass refid="classagents_1_1writer_1_1WriterAgent" prot="public">agents::writer::WriterAgent</innerclass>
    <innernamespace refid="namespaceagents">agents</innernamespace>
    <innernamespace refid="namespaceagents_1_1writer">agents::writer</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespaceagents_1_1writer" refkind="compound"><highlight class="keyword">from</highlight><highlight class="normal"><sp/>datetime<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>datetime</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>json5<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>json</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.utils.views<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>print_agent_output</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.utils.llms<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>call_model</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6" refid="namespaceagents_1_1writer_1a4c5d07e2e9e57563dbcb39ba7feddab6" refkind="member"><highlight class="normal">sample_json<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="7"><highlight class="stringliteral">{</highlight></codeline>
<codeline lineno="8"><highlight class="stringliteral"><sp/><sp/>&quot;Содержание&quot;:<sp/>A<sp/>table<sp/>of<sp/>contents<sp/>in<sp/>markdown<sp/>syntax<sp/>(using<sp/>&apos;-&apos;)<sp/>based<sp/>on<sp/>the<sp/>research<sp/>headers<sp/>and<sp/>subheaders,</highlight></codeline>
<codeline lineno="9"><highlight class="stringliteral"><sp/><sp/>&quot;Введение&quot;:<sp/>An<sp/>indepth<sp/>introduction<sp/>to<sp/>the<sp/>topic<sp/>in<sp/>markdown<sp/>syntax<sp/>and<sp/>hyperlink<sp/>references<sp/>to<sp/>relevant<sp/>sources,</highlight></codeline>
<codeline lineno="10"><highlight class="stringliteral"><sp/><sp/>&quot;Заключение&quot;:<sp/>A<sp/>conclusion<sp/>to<sp/>the<sp/>entire<sp/>research<sp/>based<sp/>on<sp/>all<sp/>research<sp/>data<sp/>in<sp/>markdown<sp/>syntax<sp/>and<sp/>hyperlink<sp/>references<sp/>to<sp/>relevant<sp/>sources,</highlight></codeline>
<codeline lineno="11"><highlight class="stringliteral"><sp/><sp/>&quot;Источники&quot;:<sp/>A<sp/>list<sp/>with<sp/>strings<sp/>of<sp/>all<sp/>used<sp/>source<sp/>links<sp/>in<sp/>the<sp/>entire<sp/>research<sp/>data<sp/>in<sp/>markdown<sp/>syntax<sp/>and<sp/>apa<sp/>citation<sp/>format.<sp/>For<sp/>example:<sp/>[&apos;-<sp/><sp/>Title,<sp/>year,<sp/>Author<sp/>[source<sp/>url](source)&apos;,<sp/>...]</highlight></codeline>
<codeline lineno="12"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="13"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="classagents_1_1writer_1_1WriterAgent" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classagents_1_1writer_1_1WriterAgent" kindref="compound">WriterAgent</ref>:</highlight></codeline>
<codeline lineno="17" refid="classagents_1_1writer_1_1WriterAgent_1aeed8e40ea98de396d419386d28507e1b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classagents_1_1writer_1_1WriterAgent_1aeed8e40ea98de396d419386d28507e1b" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="classagents_1_1writer_1_1WriterAgent_1afe89553ca1031e9847522ea8a945f50a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classagents_1_1writer_1_1WriterAgent_1afe89553ca1031e9847522ea8a945f50a" kindref="member">get_headers</ref>(self,<sp/>research_state:<sp/>dict):</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;title&quot;</highlight><highlight class="normal">:<sp/>research_state.get(</highlight><highlight class="stringliteral">&quot;title&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;date&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;Дата&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;introduction&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;Введение&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;table_of_contents&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;Содержание&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;conclusion&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;Заключение&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;references&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;Список<sp/>источников&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30" refid="classagents_1_1writer_1_1WriterAgent_1ad090d0934f61168407dec03c5c9eae4d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classagents_1_1writer_1_1WriterAgent_1ad090d0934f61168407dec03c5c9eae4d" kindref="member">write_sections</ref>(self,<sp/>research_state:<sp/>dict):</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>query<sp/>=<sp/>research_state.get(</highlight><highlight class="stringliteral">&quot;title&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>research_state.get(</highlight><highlight class="stringliteral">&quot;research_data&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task<sp/>=<sp/>research_state.get(</highlight><highlight class="stringliteral">&quot;task&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>follow_guidelines<sp/>=<sp/>task.get(</highlight><highlight class="stringliteral">&quot;follow_guidelines&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guidelines<sp/>=<sp/>task.get(</highlight><highlight class="stringliteral">&quot;guidelines&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prompt<sp/>=<sp/>[{</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;role&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;system&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;content&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;You<sp/>are<sp/>a<sp/>research<sp/>writer.<sp/>Your<sp/>sole<sp/>purpose<sp/>is<sp/>to<sp/>write<sp/>a<sp/>well-written<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;research<sp/>reports<sp/>in<sp/>Russian<sp/>about<sp/>a<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;topic<sp/>based<sp/>on<sp/>research<sp/>findings<sp/>and<sp/>information.\n<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;role&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;content&quot;</highlight><highlight class="normal">:<sp/>f</highlight><highlight class="stringliteral">&quot;Today&apos;s<sp/>date<sp/>is<sp/>{datetime.now().strftime(&apos;%d/%m/%Y&apos;)}\n.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;Query<sp/>or<sp/>Topic:<sp/>{query}\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;Research<sp/>data:<sp/>{str(data)}\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;Your<sp/>task<sp/>is<sp/>to<sp/>write<sp/>an<sp/>in<sp/>depth,<sp/>well<sp/>written<sp/>and<sp/>detailed<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;introduction<sp/>and<sp/>conclusion<sp/>to<sp/>the<sp/>research<sp/>report<sp/>based<sp/>on<sp/>the<sp/>provided<sp/>research<sp/>data.<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;Do<sp/>not<sp/>include<sp/>headers<sp/>in<sp/>the<sp/>results.\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;You<sp/>MUST<sp/>include<sp/>any<sp/>relevant<sp/>sources<sp/>to<sp/>the<sp/>introduction<sp/>and<sp/>conclusion<sp/>as<sp/>markdown<sp/>hyperlinks<sp/>-&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;For<sp/>example:<sp/>&apos;This<sp/>is<sp/>a<sp/>sample<sp/>text.<sp/>([url<sp/>website](url))&apos;\n\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;{f&apos;You<sp/>must<sp/>follow<sp/>the<sp/>guidelines<sp/>provided:<sp/>{guidelines}&apos;<sp/>if<sp/>follow_guidelines<sp/>else<sp/>&apos;&apos;}\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;You<sp/>MUST<sp/>return<sp/>nothing<sp/>but<sp/>a<sp/>JSON<sp/>in<sp/>the<sp/>following<sp/>format<sp/>(without<sp/>json<sp/>markdown):\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;{sample_json}\n\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;<sp/>You<sp/>must<sp/>write<sp/>in<sp/>Russian.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}]</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response<sp/>=<sp/>call_model(prompt,<sp/>task.get(</highlight><highlight class="stringliteral">&quot;model&quot;</highlight><highlight class="normal">),<sp/>max_retries=2,<sp/>response_format=</highlight><highlight class="stringliteral">&apos;json&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>json.loads(response)</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="classagents_1_1writer_1_1WriterAgent_1a1fc2cc02dd6d702e2d3599086f26dc8f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classagents_1_1writer_1_1WriterAgent_1a1fc2cc02dd6d702e2d3599086f26dc8f" kindref="member">revise_headers</ref>(self,<sp/>task:<sp/>dict,<sp/>headers:<sp/>dict):</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prompt<sp/>=<sp/>[{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;role&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;system&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;content&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;You<sp/>are<sp/>a<sp/>research<sp/>writer.</highlight></codeline>
<codeline lineno="66"><highlight class="stringliteral">Your<sp/>sole<sp/>purpose<sp/>is<sp/>to<sp/>revise<sp/>the<sp/>headers<sp/>data<sp/>based<sp/>on<sp/>the<sp/>given<sp/>guidelines.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;role&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;content&quot;</highlight><highlight class="normal">:<sp/>f</highlight><highlight class="stringliteral">&quot;&quot;&quot;Your<sp/>task<sp/>is<sp/>to<sp/>revise<sp/>the<sp/>given<sp/>headers<sp/>JSON<sp/>based<sp/>on<sp/>the<sp/>guidelines<sp/>given.</highlight></codeline>
<codeline lineno="70"><highlight class="stringliteral">You<sp/>are<sp/>to<sp/>follow<sp/>the<sp/>guidelines<sp/>but<sp/>the<sp/>values<sp/>should<sp/>be<sp/>in<sp/>simple<sp/>strings,<sp/>ignoring<sp/>all<sp/>markdown<sp/>syntax.</highlight></codeline>
<codeline lineno="71"><highlight class="stringliteral">You<sp/>must<sp/>return<sp/>nothing<sp/>but<sp/>a<sp/>JSON<sp/>in<sp/>the<sp/>same<sp/>format<sp/>as<sp/>given<sp/>in<sp/>headers<sp/>data.</highlight></codeline>
<codeline lineno="72"><highlight class="stringliteral">Guidelines:<sp/>{task.get(&quot;guidelines&quot;)}\n</highlight></codeline>
<codeline lineno="73"><highlight class="stringliteral">Headers<sp/>Data:<sp/>{headers}\n</highlight></codeline>
<codeline lineno="74"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}]</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response<sp/>=<sp/>call_model(prompt,<sp/>task.get(</highlight><highlight class="stringliteral">&quot;model&quot;</highlight><highlight class="normal">),<sp/>response_format=</highlight><highlight class="stringliteral">&apos;json&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{</highlight><highlight class="stringliteral">&quot;headers&quot;</highlight><highlight class="normal">:<sp/>json.loads(response)}</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="classagents_1_1writer_1_1WriterAgent_1aeea35fc6e190669f99d20c20409fc266" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classagents_1_1writer_1_1WriterAgent_1aeea35fc6e190669f99d20c20409fc266" kindref="member">run</ref>(self,<sp/>research_state:<sp/>dict):</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_agent_output(f</highlight><highlight class="stringliteral">&quot;Writing<sp/>final<sp/>research<sp/>report<sp/>based<sp/>on<sp/>research<sp/>data...&quot;</highlight><highlight class="normal">,<sp/>agent=</highlight><highlight class="stringliteral">&quot;WRITER&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>research_layout_content<sp/>=<sp/>self.<ref refid="classagents_1_1writer_1_1WriterAgent_1ad090d0934f61168407dec03c5c9eae4d" kindref="member">write_sections</ref>(research_state)</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>research_state.get(</highlight><highlight class="stringliteral">&quot;task&quot;</highlight><highlight class="normal">).get(</highlight><highlight class="stringliteral">&quot;verbose&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_agent_output(research_layout_content,<sp/>agent=</highlight><highlight class="stringliteral">&quot;WRITER&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/>self.<ref refid="classagents_1_1writer_1_1WriterAgent_1afe89553ca1031e9847522ea8a945f50a" kindref="member">get_headers</ref>(research_state)</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>research_state.get(</highlight><highlight class="stringliteral">&quot;task&quot;</highlight><highlight class="normal">).get(</highlight><highlight class="stringliteral">&quot;follow_guidelines&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print_agent_output(</highlight><highlight class="stringliteral">&quot;Rewriting<sp/>layout<sp/>based<sp/>on<sp/>guidelines...&quot;</highlight><highlight class="normal">,<sp/>agent=</highlight><highlight class="stringliteral">&quot;WRITER&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>headers<sp/>=<sp/>self.<ref refid="classagents_1_1writer_1_1WriterAgent_1a1fc2cc02dd6d702e2d3599086f26dc8f" kindref="member">revise_headers</ref>(task=research_state.get(</highlight><highlight class="stringliteral">&quot;task&quot;</highlight><highlight class="normal">),<sp/>headers=headers).get(</highlight><highlight class="stringliteral">&quot;headers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{**research_layout_content,<sp/></highlight><highlight class="stringliteral">&quot;headers&quot;</highlight><highlight class="normal">:<sp/>headers}</highlight></codeline>
    </programlisting>
    <location file="/tmp/github_repos_arch_doc_gen/yshishenya/rob/multi_agents/agents/writer.py"/>
  </compounddef>
</doxygen>
